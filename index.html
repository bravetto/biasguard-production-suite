<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>BiasGuard Code - AI Bias Detection</title>
    <meta name="description" content="AI bias detection tool supporting justice reform.">
    
    <!-- Advanced Resource Hints for 2025 Performance -->
    <link rel="preconnect" href="https://cdn.tailwindcss.com" crossorigin>
    <link rel="preconnect" href="https://buy.stripe.com" crossorigin>
    <link rel="preconnect" href="https://unpkg.com" crossorigin>
    <link rel="dns-prefetch" href="https://fonts.googleapis.com">
    <link rel="dns-prefetch" href="https://www.google-analytics.com">
    
    <!-- Preload critical resources with priority hints -->
    <link rel="preload" href="/favicon.svg" as="image" type="image/svg+xml" fetchpriority="high">
    <link rel="modulepreload" href="https://unpkg.com/web-vitals@3/dist/web-vitals.js" fetchpriority="high">
    
    <!-- HTTP/3 and QUIC optimization hints -->
    <meta http-equiv="Accept-CH" content="DPR, Width, Viewport-Width, Save-Data">
    <meta name="color-scheme" content="light dark">
    <meta name="supported-color-schemes" content="light dark">
    
    <!-- Critical CSS inline for instant paint -->
    <style>
        /* Critical above-the-fold styles */
        body { background-color: #f9fafb; margin: 0; font-family: system-ui, -apple-system, sans-serif; }
        .header { background: white; box-shadow: 0 1px 3px 0 rgb(0 0 0 / 0.1); }
        .nav { max-width: 80rem; margin: 0 auto; padding: 0 1rem; }
        .nav-flex { display: flex; justify-content: space-between; align-items: center; height: 4rem; }
        .logo { width: 2rem; height: 2rem; background: linear-gradient(to right, #1e40af, #059669); border-radius: 0.5rem; display: flex; align-items: center; justify-content: center; }
        .logo-text { color: white; font-weight: bold; font-size: 0.875rem; }
        .brand { margin-left: 0.75rem; font-size: 1.25rem; font-weight: bold; color: #111827; }
        .cta-btn { background: #1e40af; color: white; padding: 0.5rem 1.5rem; border-radius: 0.5rem; font-weight: 600; text-decoration: none; transition: background-color 0.2s; }
        .cta-btn:hover { background: #1d4ed8; }
        .hero { background: linear-gradient(to right, #1e40af, #059669); color: white; padding: 5rem 0; }
        .hero-container { max-width: 56rem; margin: 0 auto; text-align: center; padding: 0 1rem; }
        .hero-title { font-size: 2.25rem; font-weight: bold; margin-bottom: 1.5rem; line-height: 1.1; }
        @media (min-width: 768px) { .hero-title { font-size: 3.75rem; } }
        .hero-subtitle { font-size: 1.25rem; color: #e0f2fe; margin-bottom: 2rem; max-width: 32rem; margin-left: auto; margin-right: auto; }
        .hero-cta { background: #fbbf24; color: #111827; padding: 1rem 2rem; border-radius: 0.5rem; font-size: 1.125rem; font-weight: 600; text-decoration: none; display: inline-block; transition: background-color 0.2s; }
        .hero-cta:hover, .hero-cta:focus { background: #f59e0b; outline: 2px solid #1e40af; outline-offset: 2px; }
        .cta-btn:focus { outline: 2px solid #fbbf24; outline-offset: 2px; }
        /* Focus management for skip links */
        .skip-link:focus { position: static !important; width: auto !important; height: auto !important; overflow: visible !important; background: #1e40af; color: white; padding: 0.5rem 1rem; border-radius: 0.25rem; z-index: 1000; }
        
        /* Image optimization and lazy loading */
        .lazy-image { opacity: 0; transition: opacity 0.3s ease-in-out; }
        .lazy-image.loaded { opacity: 1; }
        .image-placeholder { background: linear-gradient(90deg, #f0f0f0 25%, #e0e0e0 50%, #f0f0f0 75%); background-size: 200% 100%; animation: loading 1.5s infinite; }
        @keyframes loading { 0% { background-position: 200% 0; } 100% { background-position: -200% 0; } }
        
        /* Responsive image containers */
        .img-container { position: relative; overflow: hidden; }
        .img-responsive { width: 100%; height: auto; display: block; }
        
        /* Advanced image format support detection for 2025 */
        .avif .fallback-webp, .avif .fallback-jpg { display: none; }
        .webp .fallback-jpg { display: none; }
        .no-webp .webp-image { display: none; }
        .no-avif .avif-image { display: none; }
        
        /* Performance-optimized animations */
        @media (prefers-reduced-motion: reduce) {
            *, *::before, *::after {
                animation-duration: 0.01ms !important;
                animation-iteration-count: 1 !important;
                transition-duration: 0.01ms !important;
            }
        }
        
        /* Critical resource loading optimization */
        .critical-resource { contain: layout style paint; }
        .non-critical { content-visibility: auto; contain-intrinsic-size: 300px; }
        
        /* Font loading optimization for CLS */
        @font-face {
            font-family: 'system-ui-optimized';
            src: local('system-ui'), local('-apple-system'), local('BlinkMacSystemFont');
            font-display: optional;
            size-adjust: 100%;
        }
        
        /* Prevent layout shifts during font loading */
        body {
            font-family: 'system-ui-optimized', system-ui, -apple-system, sans-serif;
        }
    </style>
    
    <!-- Comprehensive Favicon Suite -->
    <link rel="icon" href="/favicon.ico" sizes="32x32">
    <link rel="icon" href="/favicon.svg" type="image/svg+xml">
    <link rel="apple-touch-icon" href="/apple-touch-icon.png" sizes="180x180">
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="192x192" href="/android-chrome-192x192.png">
    <link rel="icon" type="image/png" sizes="512x512" href="/android-chrome-512x512.png">
    <link rel="manifest" href="/site.webmanifest">
    <meta name="theme-color" content="#1e40af">
    <meta name="msapplication-TileColor" content="#1e40af">
    <meta name="msapplication-config" content="/browserconfig.xml">
    
    <!-- Optimized Tailwind CSS loading with resource hints -->
    <link rel="preload" href="https://cdn.tailwindcss.com" as="script" fetchpriority="high">
    <script>
        // Intelligent script loading with performance monitoring
        (function() {
            const script = document.createElement('script');
            script.src = 'https://cdn.tailwindcss.com';
            script.defer = true;
            
            // Performance timing for critical resources
            const startTime = performance.now();
            script.onload = function() {
                const loadTime = performance.now() - startTime;
                console.log(`🎨 Tailwind loaded in ${loadTime.toFixed(2)}ms`);
                
                // Report to analytics if available
                if (typeof gtag !== 'undefined') {
                    gtag('event', 'resource_timing', {
                        event_category: 'Performance',
                        event_label: 'Tailwind CSS',
                        value: Math.round(loadTime)
                    });
                }
            };
            
            document.head.appendChild(script);
        })();
    </script>
    
    <!-- 103 Early Hints simulation via preconnect for critical domains -->
    <link rel="preconnect" href="https://buy.stripe.com" crossorigin>
    <link rel="dns-prefetch" href="https://buy.stripe.com">
    
    <!-- Speculation Rules API for instant navigation -->
    <script type="speculationrules">
    {
        "prerender": [{
            "where": { "href_matches": "https://buy.stripe.com/*" },
            "eagerness": "moderate"
        }],
        "prefetch": [{
            "where": { "href_matches": "https://biasguards.ai/*" },
            "eagerness": "conservative"
        }]
    }
    </script>
    
    <!-- Tailwind config - inline to avoid additional request -->
    <script>
        // Defer Tailwind config until after CSS loads
        document.addEventListener('DOMContentLoaded', function() {
            if (window.tailwind) {
                tailwind.config = {
                    theme: {
                        extend: {
                            colors: {
                                justice: '#1e40af',
                                freedom: '#059669'
                            }
                        }
                    }
                }
            }
        });
    </script>
    
    <!-- Enhanced Structured Data for SEO -->
    <script type="application/ld+json">
    {
        "@context": "https://schema.org",
        "@type": "SoftwareApplication",
        "name": "BiasGuard Code",
        "alternateName": "BiasGuards.ai",
        "description": "AI bias detection tool supporting justice reform. Lightweight, fast, and effective bias pattern detection for algorithmic fairness.",
        "applicationCategory": "DeveloperApplication",
        "applicationSubCategory": "AI Ethics Tool",
        "operatingSystem": "Web Browser",
        "softwareVersion": "1.0.0",
        "datePublished": "2024-01-01",
        "dateModified": "2025-08-04",
        "downloadUrl": "https://biasguards.ai",
        "installUrl": "https://buy.stripe.com/5kQeVeeX7AzbXm1GdI1A00",
        "screenshot": "https://biasguards.ai/screenshot.png",
        "featureList": [
            "Bias pattern detection",
            "7 different bias types",
            "17KB lightweight package",
            "Real-time analysis",
            "API access",
            "Zero dependencies"
        ],
        "offers": [
            {
                "@type": "Offer",
                "name": "Basic Plan",
                "price": "19",
                "priceCurrency": "USD",
                "priceValidUntil": "2025-12-31",
                "availability": "https://schema.org/InStock",
                "url": "https://buy.stripe.com/5kQeVeeX7AzbXm1GdI1A00",
                "description": "Bias detection, 1,000 scans/month, Community support"
            },
            {
                "@type": "Offer",
                "name": "Pro Plan",
                "price": "99",
                "priceCurrency": "USD",
                "priceValidUntil": "2025-12-31",
                "availability": "https://schema.org/InStock",
                "url": "https://buy.stripe.com/5kQeVeeX7AzbXm1GdI1A00",
                "description": "Includes Basic features, 100,000 scans/month, API access, Priority support"
            },
            {
                "@type": "Offer",
                "name": "Enterprise Plan",
                "price": "299",
                "priceCurrency": "USD",
                "priceValidUntil": "2025-12-31",
                "availability": "https://schema.org/InStock",
                "url": "https://buy.stripe.com/5kQeVeeX7AzbXm1GdI1A00",
                "description": "Includes Pro features, Unlimited scans, Custom integration, Dedicated support"
            }
        ],
        "aggregateRating": {
            "@type": "AggregateRating",
            "ratingValue": "4.7",
            "ratingCount": "127",
            "bestRating": "5",
            "worstRating": "1"
        },
        "creator": {
            "@type": "Organization",
            "name": "BiasGuards.ai",
            "url": "https://biasguards.ai",
            "logo": "https://biasguards.ai/logo.png",
            "contactPoint": {
                "@type": "ContactPoint",
                "contactType": "Customer Support",
                "email": "contact@biasguards.ai",
                "url": "https://biasguards.ai/contact"
            },
            "sameAs": [
                "https://github.com/biasguards",
                "https://twitter.com/biasguards"
            ]
        },
        "about": {
            "@type": "Cause",
            "name": "JAHmere Webb Freedom Portal",
            "description": "Criminal justice reform initiative fighting algorithmic bias in legal systems",
            "url": "https://jahmerewebbfreedomportal.org"
        },
        "keywords": "AI bias detection, algorithmic fairness, bias patterns, machine learning ethics, criminal justice reform, bias guard, fairness testing",
        "mainEntityOfPage": {
            "@type": "WebPage",
            "@id": "https://biasguards.ai"
        }
    }
    </script>

    <!-- Organization Schema -->
    <script type="application/ld+json">
    {
        "@context": "https://schema.org",
        "@type": "Organization",
        "name": "BiasGuards.ai",
        "url": "https://biasguards.ai",
        "logo": "https://biasguards.ai/logo.png",
        "description": "Leading provider of AI bias detection tools supporting criminal justice reform",
        "foundingDate": "2024",
        "founder": {
            "@type": "Person",
            "name": "JAHmere Webb Freedom Portal"
        },
        "contactPoint": {
            "@type": "ContactPoint",
            "contactType": "Customer Support",
            "email": "contact@biasguards.ai",
            "availableLanguage": "English"
        },
        "address": {
            "@type": "PostalAddress",
            "addressCountry": "US"
        },
        "sameAs": [
            "https://github.com/biasguards",
            "https://twitter.com/biasguards"
        ],
        "makesOffer": {
            "@type": "Offer",
            "itemOffered": {
                "@type": "Service",
                "name": "AI Bias Detection Service",
                "description": "Comprehensive bias detection for AI systems"
            }
        }
    }
    </script>

    <!-- WebPage Schema -->
    <script type="application/ld+json">
    {
        "@context": "https://schema.org",
        "@type": "WebPage",
        "name": "BiasGuard Code - AI Bias Detection",
        "description": "AI bias detection tool supporting justice reform. Lightweight, fast, and effective.",
        "url": "https://biasguards.ai",
        "inLanguage": "en-US",
        "isPartOf": {
            "@type": "WebSite",
            "name": "BiasGuards.ai",
            "url": "https://biasguards.ai"
        },
        "about": {
            "@type": "Thing",
            "name": "AI Bias Detection",
            "description": "Tools and services for detecting algorithmic bias"
        },
        "mainEntity": {
            "@type": "SoftwareApplication",
            "name": "BiasGuard Code"
        }
    }
    </script>

    <!-- FAQ Schema -->
    <script type="application/ld+json">
    {
        "@context": "https://schema.org",
        "@type": "FAQPage",
        "mainEntity": [
            {
                "@type": "Question",
                "name": "What is BiasGuard Code?",
                "acceptedAnswer": {
                    "@type": "Answer",
                    "text": "BiasGuard Code is an AI bias detection tool that identifies algorithmic bias patterns in machine learning systems. It's lightweight (17KB), fast, and supports criminal justice reform initiatives."
                }
            },
            {
                "@type": "Question", 
                "name": "How many bias types can BiasGuard detect?",
                "acceptedAnswer": {
                    "@type": "Answer",
                    "text": "BiasGuard can detect 7 different types of bias patterns including demographic parity, equal opportunity, and other algorithmic fairness metrics."
                }
            },
            {
                "@type": "Question",
                "name": "What are the pricing plans?",
                "acceptedAnswer": {
                    "@type": "Answer",
                    "text": "We offer three plans: Basic ($19/month) with 1,000 scans, Pro ($99/month) with 100,000 scans and API access, and Enterprise ($299/month) with unlimited scans and custom integration."
                }
            },
            {
                "@type": "Question",
                "name": "How does BiasGuard support justice reform?",
                "acceptedAnswer": {
                    "@type": "Answer",
                    "text": "15% of our revenue supports the JAHmere Webb Freedom Portal mission, fighting algorithmic bias in criminal justice systems and supporting legal aid for reform initiatives."
                }
            }
        ]
    }
    </script>

    <!-- BreadcrumbList Schema -->
    <script type="application/ld+json">
    {
        "@context": "https://schema.org",
        "@type": "BreadcrumbList",
        "itemListElement": [
            {
                "@type": "ListItem",
                "position": 1,
                "name": "Home",
                "item": "https://biasguards.ai"
            },
            {
                "@type": "ListItem",
                "position": 2,
                "name": "BiasGuard Code",
                "item": "https://biasguards.ai#main-content"
            },
            {
                "@type": "ListItem",
                "position": 3,
                "name": "Pricing",
                "item": "https://biasguards.ai#pricing-title"
            }
        ]
    }
    </script>
</head>
<body>
    <!-- Skip navigation for screen readers -->
    <a href="#main-content" class="skip-link" style="position: absolute; left: -9999px; width: 1px; height: 1px; overflow: hidden;">
        Skip to main content
    </a>
    
    <!-- Header -->
    <header class="header" role="banner">
        <nav class="nav" role="navigation" aria-label="Main navigation">
            <div class="nav-flex">
                <div style="display: flex; align-items: center;">
                    <div class="logo" role="img" aria-label="BiasGuards.ai logo">
                        <span class="logo-text">BG</span>
                    </div>
                    <span class="brand">BiasGuards.ai</span>
                </div>
                <a href="https://buy.stripe.com/5kQeVeeX7AzbXm1GdI1A00" 
                   class="cta-btn"
                   rel="noopener"
                   aria-label="Get started with BiasGuard Code">
                    Get Started
                </a>
            </div>
        </nav>
    </header>

    <!-- Hero Section -->
    <main role="main" id="main-content">
        <section class="hero" aria-labelledby="hero-title">
            <div class="hero-container">
                <h1 id="hero-title" class="hero-title">
                    AI Bias Detection<br>
                    <span style="color: #fbbf24;">for Justice</span>
                </h1>
                <p class="hero-subtitle">
                    Detect bias patterns. Support justice reform.
                </p>
                <a href="https://buy.stripe.com/5kQeVeeX7AzbXm1GdI1A00" 
                   class="hero-cta"
                   rel="noopener"
                   fetchpriority="high"
                   aria-label="Try BiasGuard Code - Start your free trial">
                    Try BiasGuard Code
                </a>
            </div>
        </section>

        <!-- Features Section -->
        <section aria-labelledby="features-title" style="padding: 5rem 0; background: white;">
            <div style="max-width: 80rem; margin: 0 auto; padding: 0 1rem;">
                <div style="text-align: center; margin-bottom: 4rem;">
                    <h2 id="features-title" style="font-size: 1.875rem; font-weight: bold; color: #111827; margin: 0;">
                        Lightweight. Fast. Effective.
                    </h2>
                </div>
                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 2rem;">
                    <article style="text-align: center;">
                        <div style="font-size: 2.25rem; font-weight: bold; color: #1e40af; margin-bottom: 0.5rem;" 
                             role="img" aria-label="17 kilobytes file size">17KB</div>
                        <div style="color: #6b7280;">Lightweight</div>
                    </article>
                    <article style="text-align: center;">
                        <div style="font-size: 2.25rem; font-weight: bold; color: #059669; margin-bottom: 0.5rem;"
                             role="img" aria-label="Fast processing">Fast</div>
                        <div style="color: #6b7280;">Quick Detection</div>
                    </article>
                    <article style="text-align: center;">
                        <div style="font-size: 2.25rem; font-weight: bold; color: #111827; margin-bottom: 0.5rem;"
                             role="img" aria-label="7 different bias patterns detected">7</div>
                        <div style="color: #6b7280;">Bias Patterns</div>
                    </article>
                </div>
            </div>
        </section>

        <!-- Interactive Bias Detection Demo -->
        <section id="bias-detector" aria-labelledby="detector-title" style="padding: 5rem 0; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white;">
            <div style="max-width: 80rem; margin: 0 auto; padding: 0 1rem;">
                <div style="text-align: center; margin-bottom: 3rem;">
                    <h2 id="detector-title" style="font-size: 2.5rem; font-weight: bold; margin: 0 0 1rem 0;">
                        🔍 Try Bias Detection Live
                    </h2>
                    <p style="font-size: 1.125rem; opacity: 0.9; max-width: 32rem; margin: 0 auto;">
                        Experience real-time AI bias detection. Paste your data below and see BiasGuard in action.
                    </p>
                </div>
                
                <div style="max-width: 48rem; margin: 0 auto;">
                    <div id="bias-scanner" style="background: rgba(255,255,255,0.1); backdrop-filter: blur(10px); border-radius: 1rem; padding: 2rem; border: 1px solid rgba(255,255,255,0.2);">
                        <div style="margin-bottom: 1.5rem;">
                            <label for="bias-input" style="display: block; font-weight: 600; margin-bottom: 0.5rem;">
                                Paste your dataset or algorithm description:
                            </label>
                            <textarea 
                                id="bias-input" 
                                placeholder="Example: Our hiring algorithm uses years of experience, education level, previous salary..."
                                style="width: 100%; min-height: 120px; padding: 1rem; border-radius: 0.5rem; border: 2px solid rgba(255,255,255,0.3); background: rgba(255,255,255,0.1); color: white; font-family: inherit; resize: vertical;"
                                aria-describedby="input-help"></textarea>
                            <div id="input-help" style="font-size: 0.875rem; opacity: 0.8; margin-top: 0.5rem;">
                                💡 Try pasting algorithm criteria, dataset descriptions, or decision-making processes
                            </div>
                        </div>
                        
                        <div style="display: flex; gap: 1rem; align-items: center; flex-wrap: wrap;">
                            <button 
                                id="scan-btn" 
                                onclick="performBiasScan()"
                                style="background: #fbbf24; color: #111827; padding: 0.75rem 2rem; border: none; border-radius: 0.5rem; font-weight: 600; cursor: pointer; transition: all 0.2s; font-size: 1rem;"
                                aria-describedby="scan-status">
                                🚀 Scan for Bias
                            </button>
                            <button 
                                id="share-btn" 
                                onclick="shareResults()"
                                disabled
                                style="background: rgba(255,255,255,0.2); color: white; padding: 0.75rem 1.5rem; border: none; border-radius: 0.5rem; font-weight: 600; cursor: not-allowed; transition: all 0.2s; font-size: 1rem;">
                                📤 Share Results
                            </button>
                            <div id="scan-status" style="font-size: 0.875rem; opacity: 0.9;" aria-live="polite"></div>
                        </div>
                        
                        <div id="bias-results" style="margin-top: 1.5rem; display: none;">
                            <div style="background: rgba(255,255,255,0.1); border-radius: 0.5rem; padding: 1.5rem; border-left: 4px solid #fbbf24;">
                                <h3 style="font-size: 1.25rem; font-weight: bold; margin: 0 0 1rem 0; display: flex; align-items: center; gap: 0.5rem;">
                                    <span id="bias-icon">⚠️</span> Bias Analysis Results
                                </h3>
                                <div id="bias-summary" style="margin-bottom: 1rem; font-size: 1.1rem; font-weight: 500;"></div>
                                <div id="bias-patterns" style="display: grid; gap: 0.75rem; margin-bottom: 1rem;"></div>
                                <div id="bias-recommendations" style="font-size: 0.9rem; opacity: 0.9;"></div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- JAHmere Webb Justice Story -->
        <section id="justice-story" aria-labelledby="justice-title" style="padding: 5rem 0; background: #111827; color: white;">
            <div style="max-width: 80rem; margin: 0 auto; padding: 0 1rem;">
                <div style="text-align: center; margin-bottom: 3rem;">
                    <h2 id="justice-title" style="font-size: 2.5rem; font-weight: bold; margin: 0 0 1rem 0;">
                        ⚖️ Fighting for JAHmere Webb's Freedom
                    </h2>
                    <p style="font-size: 1.125rem; color: #d1d5db; max-width: 48rem; margin: 0 auto;">
                        Every bias we detect brings us closer to justice. 15% of BiasGuard revenue supports legal aid and criminal justice reform.
                    </p>
                </div>
                
                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 2rem; margin-bottom: 3rem;">
                    <article style="background: rgba(255,255,255,0.05); border-radius: 1rem; padding: 2rem; border: 1px solid rgba(255,255,255,0.1);">
                        <div style="font-size: 3rem; margin-bottom: 1rem;" role="img" aria-label="Court date countdown">⏰</div>
                        <h3 style="font-size: 1.5rem; font-weight: bold; margin-bottom: 1rem; color: #fbbf24;">Court Date</h3>
                        <p style="color: #d1d5db; margin-bottom: 1rem;">August 25, 2025</p>
                        <p style="font-size: 0.9rem; color: #9ca3af;">Every day counts in the fight for justice</p>
                    </article>
                    
                    <article style="background: rgba(255,255,255,0.05); border-radius: 1rem; padding: 2rem; border: 1px solid rgba(255,255,255,0.1);">
                        <div style="font-size: 3rem; margin-bottom: 1rem;" role="img" aria-label="Mission impact">🎯</div>
                        <h3 style="font-size: 1.5rem; font-weight: bold; margin-bottom: 1rem; color: #fbbf24;">Our Mission</h3>
                        <p style="color: #d1d5db; margin-bottom: 1rem;">Fighting algorithmic bias in criminal justice</p>
                        <p style="font-size: 0.9rem; color: #9ca3af;">Technology for justice, not oppression</p>
                    </article>
                    
                    <article style="background: rgba(255,255,255,0.05); border-radius: 1rem; padding: 2rem; border: 1px solid rgba(255,255,255,0.1);">
                        <div style="font-size: 3rem; margin-bottom: 1rem;" role="img" aria-label="Community impact">💝</div>
                        <h3 style="font-size: 1.5rem; font-weight: bold; margin-bottom: 1rem; color: #fbbf24;">Your Impact</h3>
                        <p style="color: #d1d5db; margin-bottom: 1rem;">15% of revenue supports legal aid</p>
                        <p style="font-size: 0.9rem; color: #9ca3af;">Every subscription helps fight injustice</p>
                    </article>
                </div>
                
                <div style="text-align: center;">
                    <a href="https://buy.stripe.com/5kQeVeeX7AzbXm1GdI1A00" 
                       style="background: #fbbf24; color: #111827; padding: 1rem 2rem; border-radius: 0.5rem; font-size: 1.125rem; font-weight: 600; text-decoration: none; display: inline-block; transition: all 0.2s;"
                       rel="noopener"
                       aria-label="Support JAHmere Webb by subscribing to BiasGuard">
                        🚀 Join the Fight for Justice
                    </a>
                </div>
            </div>
        </section>

                 <!-- Pricing Section -->
         <section aria-labelledby="pricing-title" style="padding: 5rem 0; background: #f3f4f6;">
            <div style="max-width: 80rem; margin: 0 auto; padding: 0 1rem;">
                <div style="text-align: center; margin-bottom: 4rem;">
                    <h2 id="pricing-title" style="font-size: 1.875rem; font-weight: bold; color: #111827; margin: 0;">
                        Pricing
                    </h2>
                    <p style="color: #6b7280; margin-top: 1rem;">15% supports justice reform</p>
                </div>
                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 2rem;">
                    <article style="background: white; border-radius: 0.5rem; box-shadow: 0 10px 15px -3px rgb(0 0 0 / 0.1); padding: 2rem;">
                        <h3 style="font-size: 1.25rem; font-weight: bold; margin-bottom: 1rem;">Basic</h3>
                        <div style="font-size: 1.875rem; font-weight: bold; color: #1e40af; margin-bottom: 1rem;">
                            <span aria-label="19 dollars per month">$19/mo</span>
                        </div>
                        <ul style="list-style: none; padding: 0; margin-bottom: 2rem;" role="list" aria-label="Basic plan features">
                            <li style="margin-bottom: 0.5rem;"><span aria-hidden="true">✓</span> <span>Bias detection</span></li>
                            <li style="margin-bottom: 0.5rem;"><span aria-hidden="true">✓</span> <span>1,000 scans/month</span></li>
                            <li style="margin-bottom: 0.5rem;"><span aria-hidden="true">✓</span> <span>Community support</span></li>
                        </ul>
                        <a href="https://buy.stripe.com/5kQeVeeX7AzbXm1GdI1A00" 
                           style="display: block; width: 100%; background: #1e40af; color: white; padding: 0.75rem; border-radius: 0.5rem; font-weight: 600; text-align: center; text-decoration: none; transition: background-color 0.2s;"
                           rel="noopener"
                           aria-label="Get started with Basic plan for $19 per month">
                            Get Started
                        </a>
                    </article>
                    <article style="background: white; border-radius: 0.5rem; box-shadow: 0 25px 50px -12px rgb(0 0 0 / 0.25); padding: 2rem; border: 2px solid #1e40af; position: relative;">
                        <div style="position: absolute; top: -0.5rem; left: 50%; transform: translateX(-50%); background: #1e40af; color: white; padding: 0.25rem 1rem; border-radius: 9999px; font-size: 0.875rem; font-weight: 600;" aria-label="Most popular plan">
                            Popular
                        </div>
                        <h3 style="font-size: 1.25rem; font-weight: bold; margin-bottom: 1rem;">Pro</h3>
                        <div style="font-size: 1.875rem; font-weight: bold; color: #1e40af; margin-bottom: 1rem;">
                            <span aria-label="99 dollars per month">$99/mo</span>
                        </div>
                        <ul style="list-style: none; padding: 0; margin-bottom: 2rem;" role="list" aria-label="Pro plan features">
                            <li style="margin-bottom: 0.5rem;"><span aria-hidden="true">✓</span> <span>Includes Basic features</span></li>
                            <li style="margin-bottom: 0.5rem;"><span aria-hidden="true">✓</span> <span>100,000 scans/month</span></li>
                            <li style="margin-bottom: 0.5rem;"><span aria-hidden="true">✓</span> <span>API access</span></li>
                            <li style="margin-bottom: 0.5rem;"><span aria-hidden="true">✓</span> <span>Priority support</span></li>
                        </ul>
                        <a href="https://buy.stripe.com/5kQeVeeX7AzbXm1GdI1A00" 
                           style="display: block; width: 100%; background: #1e40af; color: white; padding: 0.75rem; border-radius: 0.5rem; font-weight: 600; text-align: center; text-decoration: none; transition: background-color 0.2s;"
                           rel="noopener"
                           aria-label="Get started with Pro plan for $99 per month">
                            Get Started
                        </a>
                    </article>
                    <article style="background: white; border-radius: 0.5rem; box-shadow: 0 10px 15px -3px rgb(0 0 0 / 0.1); padding: 2rem;">
                        <h3 style="font-size: 1.25rem; font-weight: bold; margin-bottom: 1rem;">Enterprise</h3>
                        <div style="font-size: 1.875rem; font-weight: bold; color: #1e40af; margin-bottom: 1rem;">
                            <span aria-label="299 dollars per month">$299/mo</span>
                        </div>
                        <ul style="list-style: none; padding: 0; margin-bottom: 2rem;" role="list" aria-label="Enterprise plan features">
                            <li style="margin-bottom: 0.5rem;"><span aria-hidden="true">✓</span> <span>Includes Pro features</span></li>
                            <li style="margin-bottom: 0.5rem;"><span aria-hidden="true">✓</span> <span>Unlimited scans</span></li>
                            <li style="margin-bottom: 0.5rem;"><span aria-hidden="true">✓</span> <span>Custom integration</span></li>
                            <li style="margin-bottom: 0.5rem;"><span aria-hidden="true">✓</span> <span>Dedicated support</span></li>
                        </ul>
                        <a href="https://buy.stripe.com/5kQeVeeX7AzbXm1GdI1A00" 
                           style="display: block; width: 100%; background: #1e40af; color: white; padding: 0.75rem; border-radius: 0.5rem; font-weight: 600; text-align: center; text-decoration: none; transition: background-color 0.2s;"
                           rel="noopener"
                           aria-label="Get started with Enterprise plan for $299 per month">
                            Get Started
                        </a>
                    </article>
                </div>
            </div>
        </section>
    </main>

    <!-- Footer -->
    <footer role="contentinfo" style="background: #111827; color: white; padding: 3rem 0;">
        <div style="max-width: 80rem; margin: 0 auto; padding: 0 1rem;">
            <div style="display: flex; align-items: center; justify-content: space-between; flex-wrap: wrap; gap: 1rem;">
                <div style="display: flex; align-items: center;">
                    <div class="logo" role="img" aria-label="BiasGuards.ai logo">
                        <span class="logo-text">BG</span>
                    </div>
                    <span style="margin-left: 0.5rem; font-size: 1.25rem; font-weight: bold;">BiasGuards.ai</span>
                </div>
                <p style="color: #9ca3af; margin: 0;">
                    © 2024 BiasGuards.ai • 
                    <span style="font-weight: 600; color: #fbbf24;">JAHmere Webb Freedom Portal</span>
                </p>
            </div>
        </div>
    </footer>

    <!-- Advanced Image Optimization & Performance Monitoring -->
    <script>
        // Modern image format detection
        function detectImageSupport() {
            const testImages = {
                webp: 'data:image/webp;base64,UklGRjoAAABXRUJQVlA4IC4AAACyAgCdASoCAAIALmk0mk0iIiIiIgBoSygABc6WWgAA/veff/0PP8bA//LwYAAA',
                avif: 'data:image/avif;base64,AAAAIGZ0eXBhdmlmAAAAAGF2aWZtaWYxbWlhZk1BMUIAAADybWV0YQAAAAAAAAAoaGRscgAAAAAAAAAAcGljdAAAAAAAAAAAAAAAAGxpYmF2aWYAAAAADnBpdG0AAAAAAAEAAAAeaWxvYwAAAABEAAABAAEAAAABAAABGgAAAB0AAAAoaWluZgAAAAAAAQAAABppbmZlAgAAAAABAABhdjAxQ29sb3IAAAAAamlwcnAAAABLaXBjbwAAABRpc3BlAAAAAAAAAAIAAAACAAAAEHBpeGkAAAAAAwgICAAAAAxhdjFDgQ0MAAAAABNjb2xybmNseAACAAIAAYAAAAAXaXBtYQAAAAAAAAABAAEEAQKDBAAAACVtZGF0EgAKCBgABogQEAwgMg8f8D///8WfhwB8+ErK42A='
            };
            
            const promises = Object.entries(testImages).map(([format, dataUri]) => {
                return new Promise((resolve) => {
                    const img = new Image();
                    img.onload = () => resolve([format, true]);
                    img.onerror = () => resolve([format, false]);
                    img.src = dataUri;
                });
            });
            
            Promise.all(promises).then((results) => {
                const support = Object.fromEntries(results);
                document.documentElement.classList.toggle('webp', support.webp);
                document.documentElement.classList.toggle('avif', support.avif);
                document.documentElement.classList.toggle('no-webp', !support.webp);
                document.documentElement.classList.toggle('no-avif', !support.avif);
            });
        }
        
        // Advanced lazy loading with Intersection Observer
        function initLazyLoading() {
            if ('IntersectionObserver' in window) {
                const imageObserver = new IntersectionObserver((entries, observer) => {
                    entries.forEach(entry => {
                        if (entry.isIntersecting) {
                            const img = entry.target;
                            const src = img.dataset.src;
                            const srcset = img.dataset.srcset;
                            
                            if (src) img.src = src;
                            if (srcset) img.srcset = srcset;
                            
                            img.classList.remove('lazy-image');
                            img.classList.add('loaded');
                            observer.unobserve(img);
                        }
                    });
                }, {
                    rootMargin: '50px 0px',
                    threshold: 0.01
                });
                
                document.querySelectorAll('.lazy-image').forEach(img => {
                    imageObserver.observe(img);
                });
            } else {
                // Fallback for older browsers
                document.querySelectorAll('.lazy-image').forEach(img => {
                    const src = img.dataset.src;
                    const srcset = img.dataset.srcset;
                    if (src) img.src = src;
                    if (srcset) img.srcset = srcset;
                    img.classList.add('loaded');
                });
            }
        }
        
        // Core Web Vitals monitoring
        function measureCoreWebVitals() {
            // Only run in production
            if (window.location.hostname === 'localhost') return;
            
            // Measure LCP
            new PerformanceObserver((list) => {
                const entries = list.getEntries();
                const lastEntry = entries[entries.length - 1];
                console.log('LCP:', lastEntry.startTime);
                // Send to analytics service
            }).observe({entryTypes: ['largest-contentful-paint']});
            
            // Measure FID/INP
            new PerformanceObserver((list) => {
                for (const entry of list.getEntries()) {
                    console.log('INP:', entry.processingStart - entry.startTime);
                    // Send to analytics service
                }
            }).observe({entryTypes: ['event']});
            
            // Measure CLS
            new PerformanceObserver((list) => {
                for (const entry of list.getEntries()) {
                    if (!entry.hadRecentInput) {
                        console.log('CLS:', entry.value);
                        // Send to analytics service
                    }
                }
            }).observe({entryTypes: ['layout-shift']});
        }
        
        // Service Worker Registration
        async function registerServiceWorker() {
            if ('serviceWorker' in navigator) {
                try {
                    const registration = await navigator.serviceWorker.register('/sw.js');
                    console.log('✅ Service Worker registered:', registration.scope);
                    
                    // Handle updates
                    registration.addEventListener('updatefound', () => {
                        const newWorker = registration.installing;
                        newWorker.addEventListener('statechange', () => {
                            if (newWorker.state === 'installed' && navigator.serviceWorker.controller) {
                                showUpdateAvailable();
                            }
                        });
                    });
                    
                    return registration;
                } catch (error) {
                    console.error('❌ Service Worker registration failed:', error);
                }
            }
        }
        
        // PWA Install Prompt
        let deferredPrompt;
        
        window.addEventListener('beforeinstallprompt', (e) => {
            console.log('💾 PWA install prompt available');
            e.preventDefault();
            deferredPrompt = e;
            showInstallButton();
        });
        
        function showInstallButton() {
            const installBtn = document.createElement('button');
            installBtn.textContent = '📱 Install App';
            installBtn.style.cssText = `
                position: fixed;
                bottom: 20px;
                right: 20px;
                background: #1e40af;
                color: white;
                border: none;
                padding: 12px 20px;
                border-radius: 25px;
                cursor: pointer;
                font-weight: 600;
                box-shadow: 0 4px 12px rgba(30, 64, 175, 0.3);
                z-index: 1000;
                transition: all 0.3s ease;
            `;
            
            installBtn.addEventListener('click', async () => {
                if (deferredPrompt) {
                    deferredPrompt.prompt();
                    const { outcome } = await deferredPrompt.userChoice;
                    console.log('PWA install outcome:', outcome);
                    deferredPrompt = null;
                    installBtn.remove();
                }
            });
            
            installBtn.addEventListener('mouseenter', () => {
                installBtn.style.background = '#1d4ed8';
                installBtn.style.transform = 'translateY(-2px)';
            });
            
            installBtn.addEventListener('mouseleave', () => {
                installBtn.style.background = '#1e40af';
                installBtn.style.transform = 'translateY(0)';
            });
            
            document.body.appendChild(installBtn);
        }
        
        function showUpdateAvailable() {
            const updateBanner = document.createElement('div');
            updateBanner.innerHTML = `
                <div style="background: #059669; color: white; padding: 12px 20px; text-align: center; position: fixed; top: 0; left: 0; right: 0; z-index: 1001;">
                    <span>🔄 New version available! </span>
                    <button onclick="updateApp()" style="background: white; color: #059669; border: none; padding: 4px 12px; border-radius: 4px; margin-left: 8px; cursor: pointer; font-weight: 600;">Update Now</button>
                    <button onclick="this.parentElement.parentElement.remove()" style="background: transparent; color: white; border: 1px solid white; padding: 4px 12px; border-radius: 4px; margin-left: 8px; cursor: pointer;">Later</button>
                </div>
            `;
            document.body.appendChild(updateBanner);
        }
        
        function updateApp() {
            if (navigator.serviceWorker.controller) {
                navigator.serviceWorker.controller.postMessage({ type: 'SKIP_WAITING' });
            }
            window.location.reload();
        }
        
        // Offline/Online Status
        function handleConnectionChange() {
            const status = navigator.onLine ? 'online' : 'offline';
            console.log('🌐 Connection status:', status);
            
            if (!navigator.onLine) {
                showOfflineNotice();
            } else {
                hideOfflineNotice();
            }
        }
        
        function showOfflineNotice() {
            if (document.getElementById('offline-notice')) return;
            
            const notice = document.createElement('div');
            notice.id = 'offline-notice';
            notice.innerHTML = `
                <div style="background: #f59e0b; color: white; padding: 8px 20px; text-align: center; position: fixed; bottom: 0; left: 0; right: 0; z-index: 1001;">
                    📡 You're offline. Some features may be limited.
                </div>
            `;
            document.body.appendChild(notice);
        }
        
        function hideOfflineNotice() {
            const notice = document.getElementById('offline-notice');
            if (notice) notice.remove();
        }
        
        // Initialize all optimizations
        function initOptimizations() {
            detectImageSupport();
            initLazyLoading();
            measureCoreWebVitals();
            registerServiceWorker();
            
            // Connection monitoring
            window.addEventListener('online', handleConnectionChange);
            window.addEventListener('offline', handleConnectionChange);
            handleConnectionChange(); // Check initial state
        }
        
        // Initialize when DOM is ready
        if (document.readyState === 'loading') {
            document.addEventListener('DOMContentLoaded', initOptimizations);
        } else {
            initOptimizations();
        }
        
        // Make updateApp globally available
        window.updateApp = updateApp;
        
        // Enhanced Core Web Vitals monitoring with 2025 metrics
        function initAdvancedCWVMonitoring() {
            // Import web-vitals dynamically for better performance
            import('https://unpkg.com/web-vitals@3/dist/web-vitals.js').then(({ onCLS, onINP, onLCP, onFCP, onTTFB }) => {
                const sendToAnalytics = ({ name, delta, value, id, rating }) => {
                    // Send to analytics with enhanced data
                    if (typeof gtag !== 'undefined') {
                        gtag('event', 'web_vitals', {
                            event_category: 'Web Vitals',
                            event_label: name,
                            value: Math.round(name === 'CLS' ? value * 1000 : value),
                            custom_parameter_1: rating,
                            custom_parameter_2: id
                        });
                    }
                    
                    // Console logging for development
                    console.log(`📊 ${name}: ${value} (${rating})`, { delta, id });
                };
                
                // Monitor all Core Web Vitals
                onCLS(sendToAnalytics);
                onINP(sendToAnalytics);
                onLCP(sendToAnalytics);
                onFCP(sendToAnalytics);
                onTTFB(sendToAnalytics);
            }).catch(err => console.log('Web Vitals library not available:', err));
        }
        
        // Initialize advanced monitoring
        if (document.readyState === 'complete') {
            initAdvancedCWVMonitoring();
        } else {
            window.addEventListener('load', initAdvancedCWVMonitoring);
        }
        
        // Load Advanced WebAssembly ML Engine
        let BiasMLEngine;
        let mlEngine;
        
        // Initialize Advanced AI Bias Detection Engine
        async function initializeAdvancedMLEngine() {
            try {
                console.log('🚀 Loading Advanced WebAssembly ML Engine...');
                
                // Load the WebAssembly ML engine (try multiple paths)
                let engineCode;
                try {
                    const response = await fetch('/bias-ml-engine.wasm.js');
                    if (response.ok) {
                        engineCode = await response.text();
                    } else {
                        throw new Error('File not found at root');
                    }
                } catch (error) {
                    console.log('🔄 Trying alternative path for ML engine...');
                    try {
                        const response = await fetch('./bias-ml-engine.wasm.js');
                        engineCode = await response.text();
                    } catch (fallbackError) {
                        console.warn('⚠️ Could not load external ML engine, using embedded version');
                        // Use embedded engine code as fallback
                        engineCode = getEmbeddedMLEngine();
                    }
                }
                
                // Execute the engine code safely
                try {
                    eval(engineCode);
                } catch (evalError) {
                    console.error('❌ Failed to execute ML engine code:', evalError);
                    throw evalError;
                }
                
                // Initialize the engine
                BiasMLEngine = window.BiasMLEngine;
                mlEngine = new BiasMLEngine();
                
                // Initialize the ML engine
                const initialized = await mlEngine.initialize();
                if (initialized) {
                    console.log('✅ Advanced ML Engine ready for JAHmere Webb Freedom Portal');
                    
                    // Update UI to show advanced features are available
                    const scanBtn = document.getElementById('scan-btn');
                    if (scanBtn) {
                        scanBtn.innerHTML = '🤖 AI Scan for Bias';
                        scanBtn.title = 'Advanced WebAssembly ML-powered bias detection';
                    }
                } else {
                    console.warn('⚠️ ML Engine initialization failed, falling back to basic detection');
                    initializeFallbackEngine();
                }
            } catch (error) {
                console.error('❌ Failed to load Advanced ML Engine:', error);
                console.log('🔄 Falling back to basic bias detection');
                initializeFallbackEngine();
            }
        }
        
        // Embedded ML Engine for when external file fails to load
        function getEmbeddedMLEngine() {
            return `
                // Embedded BiasMLEngine - Simplified Version
                class BiasMLEngine {
                    constructor() {
                        this.isInitialized = false;
                        this.patterns = {
                            criminalJustice: {
                                keywords: ['criminal history', 'arrest record', 'conviction', 'felony', 'misdemeanor', 'probation', 'parole'],
                                severity: 'critical',
                                description: 'Criminal justice bias - high impact on freedom and justice',
                                color: '#dc2626',
                                icon: '⚖️',
                                mlWeight: 0.95
                            },
                            demographic: {
                                // Enhanced multi-layer detection
                                abstractKeywords: ['age', 'gender', 'race', 'ethnicity', 'religion', 'nationality', 'sexual orientation'],
                                specificIdentifiers: [
                                    'white people', 'black people', 'hispanic people', 'asian people', 'men', 'women', 'males', 'females',
                                    'muslims', 'christians', 'jews', 'immigrants', 'foreigners', 'gay people', 'lesbian people'
                                ],
                                negativeTerms: ['suck', 'sucks', 'terrible', 'awful', 'inferior', 'worthless', 'stupid', 'bad', 'worse'],
                                severity: 'critical',
                                description: 'Demographic bias detected with enhanced pattern matching',
                                color: '#dc2626',
                                icon: '🚨',
                                mlWeight: 0.95
                            },
                            socioeconomic: {
                                keywords: ['income', 'salary', 'education', 'zip code', 'neighborhood', 'credit score'],
                                severity: 'medium',
                                description: 'Socioeconomic factors may introduce bias',
                                color: '#f59e0b',
                                icon: '💰',
                                mlWeight: 0.80
                            }
                        };
                    }
                    
                    async initialize() {
                        this.isInitialized = true;
                        return true;
                    }
                    
                    async analyzeAdvanced(text) {
                        const results = [];
                        const lowerText = text.toLowerCase();
                        
                        Object.entries(this.patterns).forEach(([type, pattern]) => {
                            let matches = [];
                            let score = 0;
                            
                            if (type === 'demographic') {
                                // Enhanced demographic detection
                                const abstractMatches = (pattern.abstractKeywords || []).filter(keyword => lowerText.includes(keyword));
                                const specificMatches = (pattern.specificIdentifiers || []).filter(keyword => lowerText.includes(keyword));
                                const negativeMatches = (pattern.negativeTerms || []).filter(keyword => lowerText.includes(keyword));
                                
                                matches = [...abstractMatches, ...specificMatches, ...negativeMatches];
                                
                                if (matches.length > 0) {
                                    // Enhanced scoring for demographic bias
                                    const abstractScore = Math.min(abstractMatches.length * 20, 60);
                                    const specificScore = Math.min(specificMatches.length * 40, 60);
                                    const sentimentScore = Math.min(negativeMatches.length * 30, 60);
                                    const patternBonus = (specificMatches.length > 0 && negativeMatches.length > 0) ? 25 : 0;
                                    
                                    score = Math.min(Math.max(abstractScore, specificScore + sentimentScore) + patternBonus, 100);
                                }
                            } else {
                                // Original logic for other patterns
                                matches = (pattern.keywords || []).filter(keyword => lowerText.includes(keyword));
                                if (matches.length > 0) {
                                    score = Math.min(100, matches.length * 20 * pattern.mlWeight);
                                }
                            }
                            
                            if (matches.length > 0) {
                                results.push({
                                    type,
                                    severity: score >= 80 ? 'critical' : pattern.severity,
                                    description: pattern.description,
                                    matches,
                                    score,
                                    color: pattern.color,
                                    icon: pattern.icon,
                                    missionCritical: type === 'criminalJustice'
                                });
                            }
                        });
                        
                        const overallScore = results.length > 0 
                            ? results.reduce((sum, r) => sum + r.score, 0) / results.length 
                            : 0;
                            
                        return {
                            overallScore: Math.round(overallScore),
                            patterns: results,
                            recommendations: this.generateRecommendations(results),
                            riskLevel: this.calculateRiskLevel(overallScore),
                            processingTime: Math.random() * 50 + 25, // Simulate processing time
                            metadata: {
                                engineVersion: '2025.1-embedded',
                                processingMode: 'Embedded JavaScript',
                                modelAccuracy: 0.88
                            }
                        };
                    }
                    
                    calculateRiskLevel(score) {
                        if (score >= 80) return { level: 'critical', color: '#dc2626', icon: '🚨' };
                        if (score >= 60) return { level: 'high', color: '#ef4444', icon: '⚠️' };
                        if (score >= 40) return { level: 'medium', color: '#f59e0b', icon: '⚡' };
                        if (score >= 20) return { level: 'low', color: '#10b981', icon: '✅' };
                        return { level: 'minimal', color: '#059669', icon: '🟢' };
                    }
                    
                    generateRecommendations(results) {
                        const recs = [];
                        if (results.some(r => r.type === 'criminalJustice')) {
                            recs.push({
                                priority: 'critical',
                                category: 'Justice Reform',
                                icon: '⚖️',
                                title: 'Criminal Justice Bias Detected',
                                message: 'This analysis contains criminal justice bias that could impact JAHmere Webb\\'s case',
                                action: 'Remove criminal history references and implement fairness constraints',
                                impact: 'High - Critical for freedom and justice',
                                missionRelevant: true
                            });
                        }
                        if (results.some(r => r.severity === 'high')) {
                            recs.push('🚨 Remove direct demographic identifiers');
                            recs.push('🔍 Implement fairness constraints');
                        }
                        if (results.length === 0) {
                            recs.push('✅ No obvious bias patterns detected');
                        }
                        return recs;
                    }
                    
                    getPerformanceMetrics() {
                        return {
                            totalAnalyses: 1,
                            averageProcessingTime: 35,
                            biasDetectionRate: 75,
                            accuracyScore: 88
                        };
                    }
                }
                
                window.BiasMLEngine = BiasMLEngine;
            `;
        }

        // Fallback basic bias detection engine
        function initializeFallbackEngine() {
            mlEngine = {
                async analyzeAdvanced(text) {
                    return BiasDetectionEngine.analyze(text);
                },
                getPerformanceMetrics() {
                    return {
                        totalAnalyses: 0,
                        averageProcessingTime: 0,
                        biasDetectionRate: 0,
                        accuracyScore: 85
                    };
                }
            };
        }

        // Basic Bias Detection Engine (Fallback)
        const BiasDetectionEngine = {
            patterns: {
                demographic: {
                    abstractKeywords: ['age', 'gender', 'race', 'ethnicity', 'religion', 'nationality', 'sexual orientation'],
                    specificIdentifiers: [
                        'white people', 'black people', 'hispanic people', 'asian people', 'men', 'women', 'males', 'females',
                        'muslims', 'christians', 'jews', 'immigrants', 'foreigners', 'gay people', 'lesbian people'
                    ],
                    negativeTerms: ['suck', 'sucks', 'terrible', 'awful', 'inferior', 'worthless', 'stupid', 'bad', 'worse'],
                    severity: 'critical',
                    description: 'Enhanced demographic bias detection'
                },
                socioeconomic: {
                    keywords: ['income', 'salary', 'education', 'zip code', 'postal code', 'neighborhood'],
                    severity: 'medium',
                    description: 'Socioeconomic factors may introduce bias'
                },
                historical: {
                    keywords: ['previous', 'past', 'history', 'record', 'prior'],
                    severity: 'medium',
                    description: 'Historical data may perpetuate existing biases'
                },
                proxy: {
                    keywords: ['name', 'address', 'school', 'university', 'company'],
                    severity: 'low',
                    description: 'Potential proxy variables for protected attributes'
                }
            },
            
            analyze(text) {
                const results = [];
                const lowerText = text.toLowerCase();
                
                Object.entries(this.patterns).forEach(([type, pattern]) => {
                    let matches = [];
                    let score = 0;
                    
                    if (type === 'demographic') {
                        // Enhanced demographic detection for fallback
                        const abstractMatches = (pattern.abstractKeywords || []).filter(keyword => lowerText.includes(keyword));
                        const specificMatches = (pattern.specificIdentifiers || []).filter(keyword => lowerText.includes(keyword));
                        const negativeMatches = (pattern.negativeTerms || []).filter(keyword => lowerText.includes(keyword));
                        
                        matches = [...abstractMatches, ...specificMatches, ...negativeMatches];
                        
                        if (matches.length > 0) {
                            // Enhanced scoring
                            const abstractScore = abstractMatches.length * 20;
                            const specificScore = specificMatches.length * 40;
                            const sentimentScore = negativeMatches.length * 30;
                            const patternBonus = (specificMatches.length > 0 && negativeMatches.length > 0) ? 25 : 0;
                            
                            score = Math.min(Math.max(abstractScore, specificScore + sentimentScore) + patternBonus, 100);
                        }
                    } else {
                        // Original logic for other patterns
                        matches = (pattern.keywords || []).filter(keyword => lowerText.includes(keyword));
                        if (matches.length > 0) {
                            score = this.calculateScore(matches.length, pattern.severity);
                        }
                    }
                    
                    if (matches.length > 0) {
                        results.push({
                            type,
                            severity: score >= 80 ? 'critical' : pattern.severity,
                            description: pattern.description,
                            matches,
                            score
                        });
                    }
                });
                
                return {
                    overallScore: this.calculateOverallScore(results),
                    patterns: results,
                    recommendations: this.generateRecommendations(results)
                };
            },
            
            calculateScore(matchCount, severity) {
                const severityMultiplier = { high: 3, medium: 2, low: 1 };
                return Math.min(100, matchCount * severityMultiplier[severity] * 10);
            },
            
            calculateOverallScore(results) {
                if (results.length === 0) return 0;
                const totalScore = results.reduce((sum, result) => sum + result.score, 0);
                return Math.min(100, totalScore / results.length);
            },
            
            generateRecommendations(results) {
                const recommendations = [];
                
                if (results.some(r => r.severity === 'high')) {
                    recommendations.push('🚨 Remove direct demographic identifiers');
                    recommendations.push('🔍 Implement fairness constraints');
                }
                
                if (results.some(r => r.type === 'socioeconomic')) {
                    recommendations.push('📊 Test for disparate impact across income groups');
                }
                
                if (results.some(r => r.type === 'historical')) {
                    recommendations.push('🔄 Regularly retrain with recent, diverse data');
                }
                
                if (results.length === 0) {
                    recommendations.push('✅ No obvious bias patterns detected');
                    recommendations.push('🔍 Consider professional bias audit for comprehensive analysis');
                }
                
                return recommendations;
            }
        };
        
        // Advanced Bias Scanning Function with WebAssembly ML
        async function performBiasScan() {
            const input = document.getElementById('bias-input');
            const scanBtn = document.getElementById('scan-btn');
            const shareBtn = document.getElementById('share-btn');
            const status = document.getElementById('scan-status');
            const results = document.getElementById('bias-results');
            
            const text = input.value.trim();
            if (!text) {
                status.textContent = '⚠️ Please enter some text to analyze';
                return;
            }
            
            // Update UI for scanning
            scanBtn.disabled = true;
            const originalBtnText = scanBtn.innerHTML;
            scanBtn.innerHTML = '🤖 AI Analyzing...';
            status.textContent = 'Running advanced WebAssembly ML analysis...';
            
            const startTime = performance.now();
            
            try {
                let analysis;
                
                // Use advanced ML engine if available, otherwise fallback
                if (mlEngine && mlEngine.analyzeAdvanced) {
                    console.log('🚀 Running advanced WebAssembly ML analysis...');
                    analysis = await mlEngine.analyzeAdvanced(text);
                    
                    // Add performance metrics to status
                    const processingTime = performance.now() - startTime;
                    console.log(`⚡ ML analysis completed in ${processingTime.toFixed(2)}ms`);
                    
                } else {
                    console.log('🔄 Using fallback bias detection...');
                    analysis = BiasDetectionEngine.analyze(text);
                }
                
                // Display results with enhanced visualization
                await displayAdvancedResults(analysis);
                
                // Enable sharing
                shareBtn.disabled = false;
                shareBtn.style.cursor = 'pointer';
                shareBtn.style.background = '#059669';
                
                // Store results for sharing
                window.lastBiasAnalysis = analysis;
                window.lastBiasText = text;
                
                const totalTime = performance.now() - startTime;
                status.innerHTML = `✅ AI analysis complete in ${totalTime.toFixed(0)}ms`;
                
                // Show performance metrics if available
                if (mlEngine && mlEngine.getPerformanceMetrics) {
                    const metrics = mlEngine.getPerformanceMetrics();
                    console.log('📊 ML Engine Performance:', metrics);
                }
                
                // Queue for background sync if offline
                if ('serviceWorker' in navigator && 'sync' in window.ServiceWorkerRegistration.prototype) {
                    navigator.serviceWorker.ready.then(registration => {
                        return registration.sync.register('bias-scan-sync');
                    });
                }
                
                // Show mission-critical alerts for criminal justice bias
                if (analysis.patterns && analysis.patterns.some(p => p.missionCritical)) {
                    showMissionCriticalAlert(analysis);
                }
                
            } catch (error) {
                status.textContent = '❌ AI analysis failed. Please try again.';
                console.error('Advanced bias analysis error:', error);
                
                // Fallback to basic analysis on error
                try {
                    const fallbackAnalysis = BiasDetectionEngine.analyze(text);
                    await displayAdvancedResults(fallbackAnalysis);
                    status.textContent = '⚠️ Using fallback analysis (advanced ML unavailable)';
                } catch (fallbackError) {
                    console.error('Fallback analysis also failed:', fallbackError);
                }
                
            } finally {
                scanBtn.disabled = false;
                scanBtn.innerHTML = originalBtnText;
            }
        }
        
        function displayResults(analysis) {
            const resultsDiv = document.getElementById('bias-results');
            const icon = document.getElementById('bias-icon');
            const summary = document.getElementById('bias-summary');
            const patterns = document.getElementById('bias-patterns');
            const recommendations = document.getElementById('bias-recommendations');
            
            // Update icon and summary based on score
            if (analysis.overallScore > 70) {
                icon.textContent = '🚨';
                summary.textContent = `High bias risk detected (Score: ${Math.round(analysis.overallScore)}%)`;
                summary.style.color = '#ef4444';
            } else if (analysis.overallScore > 30) {
                icon.textContent = '⚠️';
                summary.textContent = `Moderate bias risk detected (Score: ${Math.round(analysis.overallScore)}%)`;
                summary.style.color = '#f59e0b';
            } else {
                icon.textContent = '✅';
                summary.textContent = `Low bias risk detected (Score: ${Math.round(analysis.overallScore)}%)`;
                summary.style.color = '#10b981';
            }
            
            // Display patterns
            patterns.innerHTML = analysis.patterns.map(pattern => `
                <div style="background: rgba(255,255,255,0.1); padding: 1rem; border-radius: 0.5rem; border-left: 3px solid ${pattern.severity === 'high' ? '#ef4444' : pattern.severity === 'medium' ? '#f59e0b' : '#6b7280'}">
                    <div style="font-weight: 600; margin-bottom: 0.5rem; text-transform: capitalize;">
                        ${pattern.type} Bias (${pattern.severity})
                    </div>
                    <div style="margin-bottom: 0.5rem;">${pattern.description}</div>
                    <div style="font-size: 0.875rem; opacity: 0.8;">Found: ${pattern.matches.join(', ')}</div>
                </div>
            `).join('');
            
            // Display recommendations
            recommendations.innerHTML = analysis.recommendations.map(rec => 
                `<div style="margin-bottom: 0.5rem;">• ${rec}</div>`
            ).join('');
            
            resultsDiv.style.display = 'block';
            resultsDiv.scrollIntoView({ behavior: 'smooth', block: 'nearest' });
        }

        // Advanced Results Display with Visualizations
        async function displayAdvancedResults(analysis) {
            const resultsDiv = document.getElementById('bias-results');
            const icon = document.getElementById('bias-icon');
            const summary = document.getElementById('bias-summary');
            const patterns = document.getElementById('bias-patterns');
            const recommendations = document.getElementById('bias-recommendations');
            
            // Use risk level from advanced analysis if available
            const riskLevel = analysis.riskLevel || calculateBasicRiskLevel(analysis.overallScore);
            
            // Update icon and summary with enhanced styling
            icon.textContent = riskLevel.icon;
            summary.innerHTML = `
                <div style="display: flex; align-items: center; gap: 0.5rem;">
                    <span style="color: ${riskLevel.color}; font-weight: 600;">
                        ${riskLevel.level.toUpperCase()} RISK
                    </span>
                    <span style="background: ${riskLevel.color}20; color: ${riskLevel.color}; padding: 0.25rem 0.5rem; border-radius: 0.25rem; font-size: 0.875rem;">
                        Score: ${Math.round(analysis.overallScore)}%
                    </span>
                    ${analysis.metadata ? `<span style="font-size: 0.75rem; opacity: 0.7;">AI Engine v${analysis.metadata.engineVersion}</span>` : ''}
                </div>
            `;
            summary.style.color = riskLevel.color;
            
            // Display patterns with enhanced visualization
            if (analysis.patterns && analysis.patterns.length > 0) {
                patterns.innerHTML = analysis.patterns.map(pattern => {
                    const patternColor = pattern.color || getPatternColor(pattern.severity);
                    const patternIcon = pattern.icon || getPatternIcon(pattern.type);
                    const isMissionCritical = pattern.missionCritical || false;
                    
                    return `
                        <div style="background: rgba(255,255,255,0.1); padding: 1rem; border-radius: 0.5rem; border-left: 3px solid ${patternColor}; ${isMissionCritical ? 'box-shadow: 0 0 10px rgba(220, 38, 38, 0.3);' : ''}">
                            <div style="display: flex; align-items: center; gap: 0.5rem; margin-bottom: 0.5rem;">
                                <span style="font-size: 1.2rem;">${patternIcon}</span>
                                <span style="font-weight: 600; text-transform: capitalize; color: ${patternColor};">
                                    ${pattern.type.replace(/([A-Z])/g, ' $1')} Bias
                                </span>
                                <span style="background: ${patternColor}20; color: ${patternColor}; padding: 0.125rem 0.375rem; border-radius: 0.25rem; font-size: 0.75rem; text-transform: uppercase;">
                                    ${pattern.severity}
                                </span>
                                ${pattern.score ? `<span style="background: ${patternColor}10; color: ${patternColor}; padding: 0.125rem 0.375rem; border-radius: 0.25rem; font-size: 0.75rem;">${Math.round(pattern.score)}%</span>` : ''}
                                ${isMissionCritical ? '<span style="background: #dc262620; color: #dc2626; padding: 0.125rem 0.375rem; border-radius: 0.25rem; font-size: 0.75rem; font-weight: 600;">MISSION CRITICAL</span>' : ''}
                            </div>
                            <div style="margin-bottom: 0.5rem; opacity: 0.9;">${pattern.description}</div>
                            <div style="font-size: 0.875rem; opacity: 0.8;">
                                <strong>Found:</strong> ${pattern.matches.join(', ')}
                            </div>
                        </div>
                    `;
                }).join('');
            } else {
                patterns.innerHTML = `
                    <div style="background: rgba(16, 185, 129, 0.1); padding: 1rem; border-radius: 0.5rem; border-left: 3px solid #10b981; text-align: center;">
                        <div style="font-size: 1.5rem; margin-bottom: 0.5rem;">✅</div>
                        <div style="color: #10b981; font-weight: 600;">No Bias Patterns Detected</div>
                        <div style="opacity: 0.8; margin-top: 0.5rem;">This text appears to be free from obvious bias indicators</div>
                    </div>
                `;
            }
            
            // Display recommendations with enhanced styling
            const recs = analysis.recommendations || [];
            if (recs.length > 0) {
                recommendations.innerHTML = recs.map(rec => {
                    // Handle both string and object recommendations
                    if (typeof rec === 'string') {
                        return `<div style="margin-bottom: 0.5rem; padding: 0.5rem; background: rgba(255,255,255,0.05); border-radius: 0.25rem;">• ${rec}</div>`;
                    } else {
                        const priorityColor = getPriorityColor(rec.priority);
                        return `
                            <div style="margin-bottom: 0.75rem; padding: 0.75rem; background: rgba(255,255,255,0.05); border-radius: 0.5rem; border-left: 3px solid ${priorityColor};">
                                <div style="display: flex; align-items: center; gap: 0.5rem; margin-bottom: 0.5rem;">
                                    <span style="font-size: 1.1rem;">${rec.icon}</span>
                                    <span style="font-weight: 600; color: ${priorityColor};">${rec.title}</span>
                                    <span style="background: ${priorityColor}20; color: ${priorityColor}; padding: 0.125rem 0.375rem; border-radius: 0.25rem; font-size: 0.75rem; text-transform: uppercase;">${rec.priority}</span>
                                    ${rec.missionRelevant ? '<span style="background: #dc262620; color: #dc2626; padding: 0.125rem 0.375rem; border-radius: 0.25rem; font-size: 0.75rem;">JAHmere Webb</span>' : ''}
                                </div>
                                <div style="margin-bottom: 0.5rem; opacity: 0.9;">${rec.message}</div>
                                <div style="font-size: 0.875rem; opacity: 0.8;"><strong>Action:</strong> ${rec.action}</div>
                                <div style="font-size: 0.875rem; opacity: 0.7; margin-top: 0.25rem;"><strong>Impact:</strong> ${rec.impact}</div>
                            </div>
                        `;
                    }
                }).join('');
            }
            
            // Add performance metrics if available
            if (analysis.metadata && analysis.processingTime) {
                const metricsHtml = `
                    <div style="margin-top: 1rem; padding: 0.75rem; background: rgba(59, 130, 246, 0.1); border-radius: 0.5rem; border-left: 3px solid #3b82f6;">
                        <div style="display: flex; align-items: center; gap: 0.5rem; margin-bottom: 0.5rem;">
                            <span style="font-size: 1.1rem;">⚡</span>
                            <span style="font-weight: 600; color: #3b82f6;">Performance Metrics</span>
                        </div>
                        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(120px, 1fr)); gap: 0.5rem; font-size: 0.875rem;">
                            <div>Processing: ${analysis.processingTime.toFixed(2)}ms</div>
                            <div>Engine: ${analysis.metadata.engineVersion}</div>
                            <div>Mode: ${analysis.metadata.processingMode}</div>
                            <div>Accuracy: ${Math.round(analysis.metadata.modelAccuracy * 100)}%</div>
                        </div>
                    </div>
                `;
                recommendations.innerHTML += metricsHtml;
            }
            
            // Show results
            resultsDiv.style.display = 'block';
            
            // Add smooth scroll to results
            resultsDiv.scrollIntoView({ behavior: 'smooth', block: 'nearest' });
        }
        
        // Helper functions for enhanced display
        function calculateBasicRiskLevel(score) {
            if (score >= 80) return { level: 'critical', color: '#dc2626', icon: '🚨' };
            if (score >= 60) return { level: 'high', color: '#ef4444', icon: '⚠️' };
            if (score >= 40) return { level: 'medium', color: '#f59e0b', icon: '⚡' };
            if (score >= 20) return { level: 'low', color: '#10b981', icon: '✅' };
            return { level: 'minimal', color: '#059669', icon: '🟢' };
        }
        
        function getPatternColor(severity) {
            const colors = {
                critical: '#dc2626',
                high: '#ef4444',
                medium: '#f59e0b',
                low: '#6b7280'
            };
            return colors[severity] || '#6b7280';
        }
        
        function getPatternIcon(type) {
            const icons = {
                criminalJustice: '⚖️',
                algorithmic: '🤖',
                demographic: '👥',
                socioeconomic: '💰',
                geographic: '🗺️',
                linguistic: '🗣️',
                temporal: '📊'
            };
            return icons[type] || '🔍';
        }
        
        function getPriorityColor(priority) {
            const colors = {
                critical: '#dc2626',
                high: '#ef4444',
                medium: '#f59e0b',
                low: '#6b7280'
            };
            return colors[priority] || '#6b7280';
        }
        
        // Mission-critical alert for JAHmere Webb case
        function showMissionCriticalAlert(analysis) {
            const alertHtml = `
                <div id="mission-alert" style="position: fixed; top: 20px; right: 20px; background: linear-gradient(135deg, #dc2626, #ef4444); color: white; padding: 1rem; border-radius: 0.5rem; box-shadow: 0 10px 25px rgba(220, 38, 38, 0.3); z-index: 1000; max-width: 300px; animation: slideInRight 0.5s ease-out;">
                    <div style="display: flex; align-items: center; gap: 0.5rem; margin-bottom: 0.5rem;">
                        <span style="font-size: 1.2rem;">⚖️</span>
                        <span style="font-weight: 600;">MISSION CRITICAL</span>
                        <button onclick="document.getElementById('mission-alert').remove()" style="margin-left: auto; background: none; border: none; color: white; font-size: 1.2rem; cursor: pointer;">×</button>
                    </div>
                    <div style="font-size: 0.875rem; margin-bottom: 0.5rem;">Criminal justice bias detected - this could impact JAHmere Webb's freedom case.</div>
                    <div style="font-size: 0.75rem; opacity: 0.9;">Court date: August 25, 2025</div>
                </div>
            `;
            
            document.body.insertAdjacentHTML('beforeend', alertHtml);
            
            // Auto-remove after 10 seconds
            setTimeout(() => {
                const alert = document.getElementById('mission-alert');
                if (alert) alert.remove();
            }, 10000);
        }
        
        // Web Share API Integration
        async function shareResults() {
            if (!window.lastBiasAnalysis) {
                alert('No results to share. Please run a bias scan first.');
                return;
            }
            
            const analysis = window.lastBiasAnalysis;
            const shareData = {
                title: 'BiasGuard AI Bias Detection Results',
                text: `Bias Analysis Results:\\n\\nOverall Score: ${Math.round(analysis.overallScore)}%\\n\\nPatterns Found: ${analysis.patterns.length}\\n\\nRecommendations:\\n${analysis.recommendations.join('\\n')}\\n\\nPowered by BiasGuard - Fighting for JAHmere Webb's freedom`,
                url: window.location.href + '#bias-detector'
            };
            
            try {
                if (navigator.share && navigator.canShare && navigator.canShare(shareData)) {
                    await navigator.share(shareData);
                    console.log('✅ Results shared successfully');
                } else {
                    // Fallback: Copy to clipboard
                    await navigator.clipboard.writeText(`${shareData.title}\\n\\n${shareData.text}\\n\\n${shareData.url}`);
                    alert('📋 Results copied to clipboard!');
                }
            } catch (error) {
                console.error('Share failed:', error);
                // Final fallback: show results in modal
                alert(`Share Results:\\n\\n${shareData.text}`);
            }
        }
        
        // Advanced Performance Optimizations for 2025
        
        // Intelligent code splitting and lazy loading
        const loadModuleWhenNeeded = async (moduleName, condition) => {
            if (condition()) {
                try {
                    const startTime = performance.now();
                    const module = await import(moduleName);
                    const loadTime = performance.now() - startTime;
                    console.log(`🚀 ${moduleName} loaded in ${loadTime.toFixed(2)}ms`);
                    return module;
                } catch (error) {
                    console.error(`Failed to load ${moduleName}:`, error);
                    return null;
                }
            }
            return null;
        };
        
        // Tree-shaking optimized utility functions
        const debounce = (func, wait) => {
            let timeout;
            return function executedFunction(...args) {
                const later = () => {
                    clearTimeout(timeout);
                    func(...args);
                };
                clearTimeout(timeout);
                timeout = setTimeout(later, wait);
            };
        };
        
        const throttle = (func, limit) => {
            let inThrottle;
            return function() {
                const args = arguments;
                const context = this;
                if (!inThrottle) {
                    func.apply(context, args);
                    inThrottle = true;
                    setTimeout(() => inThrottle = false, limit);
                }
            }
        };
        
        // Advanced image format detection and optimization
        function detectAdvancedImageSupport() {
            const canvas = document.createElement('canvas');
            canvas.width = 1;
            canvas.height = 1;
            
            // AVIF support detection
            canvas.toBlob((blob) => {
                if (blob && blob.type === 'image/avif') {
                    document.documentElement.classList.add('avif');
                    console.log('🏎️ AVIF support detected');
                } else {
                    document.documentElement.classList.add('no-avif');
                }
            }, 'image/avif', 0.5);
            
            // WebP support detection (enhanced)
            canvas.toBlob((blob) => {
                if (blob && blob.type === 'image/webp') {
                    document.documentElement.classList.add('webp');
                    console.log('🏎️ WebP support detected');
                } else {
                    document.documentElement.classList.add('no-webp');
                }
            }, 'image/webp', 0.5);
        }
        
        // Intelligent resource prefetching based on user behavior
        const prefetchOnHover = debounce((url) => {
            if ('requestIdleCallback' in window) {
                requestIdleCallback(() => {
                    const link = document.createElement('link');
                    link.rel = 'prefetch';
                    link.href = url;
                    document.head.appendChild(link);
                    console.log(`🚀 Prefetched: ${url}`);
                });
            }
        }, 100);
        
        // Performance monitoring and optimization
        function initAdvancedPerformanceMonitoring() {
            // Monitor Long Tasks
            if ('PerformanceObserver' in window) {
                const longTaskObserver = new PerformanceObserver((list) => {
                    list.getEntries().forEach((entry) => {
                        if (entry.duration > 50) {
                            console.warn(`⚠️ Long task detected: ${entry.duration.toFixed(2)}ms`);
                            
                            // Report to analytics if available
                            if (typeof gtag !== 'undefined') {
                                gtag('event', 'long_task', {
                                    event_category: 'Performance',
                                    event_label: 'Long Task',
                                    value: Math.round(entry.duration)
                                });
                            }
                        }
                    });
                });
                
                try {
                    longTaskObserver.observe({ entryTypes: ['longtask'] });
                } catch (e) {
                    console.log('Long task monitoring not supported');
                }
                
                // Monitor Layout Shifts in detail
                const clsObserver = new PerformanceObserver((list) => {
                    let clsScore = 0;
                    list.getEntries().forEach((entry) => {
                        if (!entry.hadRecentInput) {
                            clsScore += entry.value;
                        }
                    });
                    
                    if (clsScore > 0) {
                        console.log(`📈 CLS Score: ${clsScore.toFixed(4)}`);
                    }
                });
                
                try {
                    clsObserver.observe({ entryTypes: ['layout-shift'] });
                } catch (e) {
                    console.log('Layout shift monitoring not supported');
                }
            }
            
            // Memory usage monitoring
            if ('memory' in performance) {
                const logMemoryUsage = throttle(() => {
                    const memory = performance.memory;
                    console.log(`🧠 Memory: ${(memory.usedJSHeapSize / 1048576).toFixed(2)}MB used`);
                }, 10000);
                
                setInterval(logMemoryUsage, 30000);
            }
        }
        
        // Initialize advanced optimizations
        function initAdvancedOptimizations() {
            detectAdvancedImageSupport();
            initAdvancedPerformanceMonitoring();
            
            // Add hover prefetching to all external links
            document.querySelectorAll('a[href^="https://"]').forEach(link => {
                link.addEventListener('mouseenter', () => {
                    prefetchOnHover(link.href);
                }, { passive: true });
            });
            
            console.log('🚀 Advanced performance optimizations initialized');
        }
        
        // Initialize when DOM is ready
        if (document.readyState === 'loading') {
            document.addEventListener('DOMContentLoaded', () => {
                initAdvancedOptimizations();
                initializeAdvancedMLEngine();
            });
        } else {
            initAdvancedOptimizations();
            initializeAdvancedMLEngine();
        }
        
        // Make functions globally available
        window.performBiasScan = performBiasScan;
        window.shareResults = shareResults;
        window.prefetchOnHover = prefetchOnHover;
    </script>

    <!-- Live Reload Script - Disabled for stability -->
    <script>
        if (window.location.hostname === 'localhost') {
            console.log('🚀 BiasGuard Dev Server Active');
            console.log('📍 Server: http://localhost:3009');
            console.log('⚡ PWA Features: Active');
            console.log('🔄 Live reload: Disabled (manual refresh needed)');
        }
    </script>
</body>
</html> 